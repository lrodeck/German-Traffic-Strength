<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exploring Hamburg’s Urban Capabilities: A Data-Driven Dive into Attractivity and Accessibility</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="hamburg-urban-capabilities_files/libs/clipboard/clipboard.min.js"></script>
<script src="hamburg-urban-capabilities_files/libs/quarto-html/quarto.js"></script>
<script src="hamburg-urban-capabilities_files/libs/quarto-html/popper.min.js"></script>
<script src="hamburg-urban-capabilities_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hamburg-urban-capabilities_files/libs/quarto-html/anchor.min.js"></script>
<link href="hamburg-urban-capabilities_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hamburg-urban-capabilities_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hamburg-urban-capabilities_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hamburg-urban-capabilities_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hamburg-urban-capabilities_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exploring Hamburg’s Urban Capabilities: A Data-Driven Dive into Attractivity and Accessibility</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><img src="https://cdn.pixabay.com/photo/2018/01/14/11/59/architecture-3081677_1280.jpg" class="img-fluid" width="573"></p>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Hamburg, Germany’s second-largest city and a major hub for culture, commerce, and innovation, presents a fascinating case study in urban form and function. As cities globally grapple with how to best serve their residents—balancing livability, sustainability, and mobility—Hamburg offers a rich canvas of infrastructure, green spaces, and transportation systems worth analyzing in detail.</p>
<p>In this project, we explore the urban capabilities of Hamburg through the lens of <strong>spatial accessibility and attractivity</strong>. Using a hexagonal grid system layered over the city and enriched with live OpenStreetMap data, we evaluate how different areas of Hamburg perform across key dimensions: proximity to parks and major transit hubs, the density of public transport stops, and the availability of urban amenities like bars, restaurants, and leisure spaces.</p>
<p>Our analysis culminates in a composite <strong>Attractivity Index</strong>, a customizable metric designed to encapsulate the urban appeal of each neighborhood-level hexagon. This index helps reveal spatial patterns—highlighting clusters of urban vitality as well as underserved areas—through interactive visualizations and detailed geospatial metrics.</p>
<p>Additionally, we integrate public transport schedule data (GTFS) to assess real-world service frequency and district-level coverage, further grounding our analysis in the lived experience of Hamburg’s mobility landscape.</p>
<p>Whether you’re an urbanist, policymaker, or simply curious about how cities function, this analysis aims to make Hamburg’s urban DNA both visible and actionable. Read on to discover how the city’s features come together to shape where people want to live, move, and spend their time.</p>
</section>
<section id="theory" class="level1">
<h1>Theory</h1>
<p>This section concentrates on gettig to know the theoretical foundations and contemporary perspectives in urban design. I will describe the historical development of this field as well as contemporary perspectives. I will also delve deeper into how this field is and has been relevant in the realm of political science. City planning and urban design seems to be an obvious and relevant field of governance that should be observed with care.</p>
<section id="foundations-of-urban-design" class="level2">
<h2 class="anchored" data-anchor-id="foundations-of-urban-design">Foundations of Urban Design</h2>
<p>Urban design emerged as a distinct discipline in the mid-20th century, addressing the complexities of rapidly urbanizing societies. A pivotal moment in this evolution was the 1956 Urban Design Conference at Harvard University, organized by José Luis Sert. This conference marked the beginning of urban design as a self-conscious pursuit, distinct from architecture, landscape architecture, and urban planning <span class="citation" data-cites="harvard2006">(<a href="#ref-harvard2006" role="doc-biblioref"><span>“The Origins and Evolution of "Urban Design," 1956–2006”</span> 2006</a>)</span>.</p>
<p>Prior to this, urban design principles were often embedded within broader architectural and planning practices. The 1956 conference catalyzed a paradigm shift, emphasizing the need for a multidisciplinary approach to urban development. It highlighted the importance of integrating architectural design with social, economic, and environmental considerations to create cohesive urban environments <span class="citation" data-cites="barnett2006">(<a href="#ref-barnett2006" role="doc-biblioref">Barnett 2006</a>)</span>.</p>
<p>This period also saw the emergence of key figures whose work laid the foundation for modern urban design theory. Their contributions underscored the significance of human-scale development, the integration of public spaces, and the necessity of considering the lived experiences of urban inhabitants.</p>
<div class="columns">
<div class="column">
<section id="historical-foundations" class="level3">
<h3 class="anchored" data-anchor-id="historical-foundations">Historical Foundations</h3>
<p>Urban design, as a formal discipline, is a relatively recent invention, but its historical foundations stretch back centuries—embedded in practices of city-making, cultural symbolisms, and shifting ideological paradigms. Understanding its evolution necessitates tracing not only the architectural and planning traditions but also the social, philosophical, and institutional contexts that shaped its disciplinary identity.</p>
<p>Alfonso Raposo offers a genealogical perspective on the emergence of urban design, focusing on its disciplinary and institutional foundations. He argues that urban design’s origins are rooted in a multifaceted intersection of architecture, planning, and social policy. Its formal recognition evolved alongside growing institutional demands in academia, governance, and public planning sectors. These demands emerged from increasingly complex urban needs, which necessitated the integration of aesthetic, functional, and social considerations into spatial planning processes <span class="citation" data-cites="raposo2006diseno">(<a href="#ref-raposo2006diseno" role="doc-biblioref">Raposo 2006</a>)</span>.</p>
</section>
</div><div class="column">
<p>Wolfgang Sonne delves deeper into the historiography of urban design, highlighting that early urban design history was not strictly confined to architectural history <span class="citation" data-cites="sonne2005birth">(<a href="#ref-sonne2005birth" role="doc-biblioref">Sonne 2005</a>)</span>. Influences ranged from Camillo Sitte’s formal urban theories to interdisciplinary works found in planning texts like Burnham’s <em>Plan of Chicago</em> (1909). Sonne emphasizes that the urban design narrative was never purely architectural—it reflected economic, political, and artistic interpretations of urban form. This multidisciplinary spirit laid the foundation for urban design’s emergence as a hybrid field focused on interpreting, shaping, and narrating the built environment.</p>
<p>The Modernist movement in the mid-20th century brought a paradox to the historical consciousness of urban design. Michael Hebbert critiques this era for its attempt to sever ties with historical legacies. Modernist urbanism, inspired by avant-garde abstraction (as in Mondrian’s art), aimed to reinvent urban space from an ideological “blank slate” <span class="citation" data-cites="hebbert2017historical">(<a href="#ref-hebbert2017historical" role="doc-biblioref">Hebbert 2017</a>)</span>. Yet, as Hebbert points out, this erasure was theoretical—the urban canvas was already layered with social, economic, and cultural complexity. Thus, Modernism became both a rejection and reinterpretation of history, giving rise to new urban design doctrines that aimed to supersede tradition while inadvertently reconfiguring it.</p>
</div>
</div>
<p>Ali Madanipour’s work <em>Designing the City of Reason</em> examines this philosophical pivot by situating urban design within the rise of rationalist thought. He traces how Enlightenment ideals—order, logic, and functionality—shaped urban planning ideals. Over time, these rationalist foundations informed the physical layouts of cities and their symbolic representations. Madanipour argues that cities became artifacts of belief systems, where philosophical doctrines like positivism and utilitarianism were inscribed onto the urban fabric <span class="citation" data-cites="madanipour2007reason">(<a href="#ref-madanipour2007reason" role="doc-biblioref">Madanipour 2007</a>)</span>.</p>
<p>Peter Laurence offers a compelling account of the post-World War II phase, when urban design began to crystallize into a coherent research agenda. Through the support of the Rockefeller Foundation, key figures such as Jane Jacobs and Kevin Lynch conducted pioneering work that emphasized user experience, visual perception, and socio-spatial equity. <span class="citation" data-cites="laurence2006jacobs">Laurence (<a href="#ref-laurence2006jacobs" role="doc-biblioref">2006</a>)</span> underscores Jacobs’ critical role in challenging top-down models of urban renewal, advocating for organic urbanism and citizen-centered design. This period, he asserts, marks the definitive emergence of urban design as a distinct and applied research field, enriched by empirical and participatory frameworks.</p>
<p>The historical foundations of urban design are deeply layered, shaped by interdisciplinary influences and ideological shifts. From its early theoretical roots in classical and Renaissance town-making, through its Modernist reinvention and post-war critique, urban design has evolved as both a reflection and determinant of societal values. Today’s urban design carries this complex heritage, demanding a historically informed and context-sensitive approach to shaping cities.</p>
<section id="foundational-contributions" class="level3">
<h3 class="anchored" data-anchor-id="foundational-contributions">Foundational Contributions</h3>
<div class="columns">
<div class="column">
<p>Urban design’s historical foundations are tightly linked to the development of cities, often through utilitarian and aesthetic lenses. Yet, as argued by <span class="citation" data-cites="oktay2016critical">Oktay (<a href="#ref-oktay2016critical" role="doc-biblioref">2016</a>)</span>, the ambiguity of urban design’s boundaries—between architecture, planning, and landscape architecture—has prompted calls for clearer definition and disciplinary identity.</p>
<p>The discipline also reflects a dynamic interplay between form and function, with urban form shaping social interaction and identity. <span class="citation" data-cites="hoffmann2001perspective">Hoffmann, Stumptner, and Chalabi (<a href="#ref-hoffmann2001perspective" role="doc-biblioref">2001</a>)</span> conceptualize design not as a linear process, but as a set of evolving perspectives—underscoring urban design as an iterative, creative discipline that navigates between constraints and innovation.</p>
<p>Philip D. Plowright and Anirban Adhya offer one of the most recent and accessible contributions to the conceptual terrain of urban design. In <em>Urban Design Made by Humans</em>, they emphasize that the foundation of urban space lies in the embodied experiences of its users <span class="citation" data-cites="plowright2022humans">(<a href="#ref-plowright2022humans" role="doc-biblioref">Plowright and Adhya 2022</a>)</span>. Their framework organizes 56 concepts around how people perceive, navigate, and interact with cities. According to the authors, urban design is not just about buildings or aesthetics, but about structuring environments that enhance human well-being and cognition. This approach asserts that every design decision should reflect how people think and feel about their environment, making human behavior and perceptual patterns central to good urban design.</p>
</div><div class="column">
<p>The concept of “place” is among the most pivotal in urban design theory. <span class="citation" data-cites="sepe2014place">Sepe and Pitt (<a href="#ref-sepe2014place" role="doc-biblioref">2014</a>)</span> examine this idea in detail in their paper on the characters of place. They argue that “place” in urban contexts is both a material and symbolic concept. It encompasses environmental, historical, psychological, and sociological dimensions. Places are not just physical locations; they are embedded with meanings, memories, and identity markers. The authors emphasize the porous and resistant nature of place—it receives influences and interactions while also holding unique characteristics that resist homogenization. Importantly, place identity is not about uniformity but uniqueness and individuality, marking it as a core value in place-making strategies.</p>
<p><span class="citation" data-cites="urban2023cities"><em>Urban Design: Cities in Past, Present and Future</em> (<a href="#ref-urban2023cities" role="doc-biblioref">2023</a>)</span> highlights the disciplinary convergence that defines contemporary urban design. By bringing together contributions from archaeology, health, transport, and climate studies, the volume underscores the necessity of interdisciplinary thinking. It demonstrates how urban design is influenced by and influences factors such as historical memory, health equity, and climate resilience. The contributors argue that designing cities requires an understanding of their temporal evolution and future trajectories. In this view, urban design becomes an interface between history, policy, and innovation, making it essential for addressing modern challenges such as aging populations and environmental stress.</p>
</div>
</div>
<p>In addressing the operational systems behind urban life, <span class="citation" data-cites="maghraoui2017mobility">Maghraoui et al. (<a href="#ref-maghraoui2017mobility" role="doc-biblioref">2017</a>)</span> focus on urban mobility as a representative challenge of urban design. Their work argues that urban mobility should be seen not as a set of disconnected elements—vehicles, roads, services—but as a unified user experience. They propose reframing mobility through the lens of human-centered design, where every element supports a cohesive journey experience. This systems-based thinking is fundamental in designing livable cities that are responsive to human needs and sustainable operations.</p>
<p><img src="https://cdn.pixabay.com/photo/2023/01/21/22/33/hamburg-7735229_1280.jpg" class="img-fluid"></p>
</section>
<section id="contemporary-approaches" class="level3">
<h3 class="anchored" data-anchor-id="contemporary-approaches">Contemporary Approaches</h3>
<p>Contemporary urban design scholarship increasingly emphasizes the interrelation between space, society, and power. Lorzangeneh builds upon Alexander Cuthbert’s “spatial political economy” to argue that urban design should not merely borrow frameworks from allied fields but establish itself through a dialectical process that integrates theory and place-making practice <span class="citation" data-cites="alexander1977">(<a href="#ref-alexander1977" role="doc-biblioref">Alexander, Ishikawa, and Silverstein 1977</a>)</span>. <span class="citation" data-cites="harfield2010social">Harfield (<a href="#ref-harfield2010social" role="doc-biblioref">2010</a>)</span>, similarly, highlights urban design as a medium for social benefit, critiquing its overemphasis on physicality and formal aesthetics. He calls for an orientation toward inclusivity, infrastructure, sustainability, and cohesion, asserting that urban design outcomes should tangibly benefit communities beyond their visual or economic value.</p>
<p>Derya Oktay’s critical review highlights the blurred boundaries and conceptual ambiguities that continue to challenge urban design <span class="citation" data-cites="oktay2016critical">(<a href="#ref-oktay2016critical" role="doc-biblioref">Oktay 2016</a>)</span>. She emphasizes that urban design today must transition from being a form-centric enterprise to an interdisciplinary and place-oriented approach. Oktay critiques how the disjunction between “urban” and “design” limits the field’s potential to respond to sustainability and social equity. Her work advocates for rethinking urban design’s role, scale, and interdisciplinary practices in shaping resilient, equitable cities. <span class="citation" data-cites="lima2015digital">Lima, Lima, and Mazivieiro (<a href="#ref-lima2015digital" role="doc-biblioref">2015</a>)</span> explore a crucial contemporary shift: the integration of digital processes in urban design. Their study outlines how parametric design systems, which focus on the parameters generating urban forms rather than the forms themselves, are revolutionizing urban planning. These systems enable dynamic modifications throughout the design process, enhancing adaptability and coherence in urban interventions. The paper presents real-world cases demonstrating how this methodology augments flexibility and control at an urban scale, although it also warns against the risk of over-dependence on technological abstraction.</p>
<p>A comprehensive dissertation on the disconnect between traditional design theories and the contemporary needs of sustainability was published by <span class="citation" data-cites="shahreen2012sustainability">Shahreen (<a href="#ref-shahreen2012sustainability" role="doc-biblioref">2012</a>)</span>. Through the case study of Liverpool, <span class="citation" data-cites="shahreen2012sustainability">Shahreen (<a href="#ref-shahreen2012sustainability" role="doc-biblioref">2012</a>)</span> explores how urban regeneration practices are adjusting to climate, economic, and social imperatives. They identify the failures of conventional models and illustrates how collaborative, policy-driven, and context-aware design practices can achieve more effective and inclusive sustainable development. Her research showes how sustainable urbanism must be embedded within governance, land use planning, and community engagement strategies.</p>
</section>
</section>
<section id="urban-design-power-and-michel-foucault" class="level2">
<h2 class="anchored" data-anchor-id="urban-design-power-and-michel-foucault">Urban Design, Power and Michel Foucault</h2>
<p>Michel Foucault’s work reveals power not as something held but as a relational and productive force that structures social realities. Urban design, when seen through this lens, becomes a political technology—a spatial expression of governmental rationalities. Foucault shifted focus from sovereign power to disciplinary and bio-political mechanisms, arguing that modern power develops diffuse, often invisible networks through institutions, norms, and spaces. Cities, with their zoning, surveillance, and infrastructure, materialize these mechanisms.</p>
<p><span class="citation" data-cites="kirsanova2024space">Kirsanova (<a href="#ref-kirsanova2024space" role="doc-biblioref">2024</a>)</span> argues that space is central to Foucault’s theory of power, where spatial arrangements are not neutral but structured to enable control, supervision, and discipline. She highlights that spatial organization becomes a platform where social hierarchies are visualized and enacted. Foucault’s disciplinary mechanisms—such as visibility, surveillance, and enclosure—rely on spatial structuring, as seen in prisons, hospitals, and urban grids. This spatiality of power allows authority to act through architecture, turning the city into a network of normative orders. <span class="citation" data-cites="barros2023urbano">Barros (<a href="#ref-barros2023urbano" role="doc-biblioref">2023</a>)</span> extends this to biopolitics, illustrating how urban spaces are shaped by state rationalities that manage populations through segregation and infrastructural inequalities. His study shows that modern cities are shaped by rationalities that govern through spatial distribution, exclusion, and racialized state control. The city becomes a site of bio-governance, where population control is achieved not just through laws but through uneven development, access to resources, and spatial stratification.</p>
<p>Gordana Fontana-Giusti explores how Foucault’s concepts of enclosure, discipline, and aesthetics have reshaped architectural thinking <span class="citation" data-cites="fontanagiusti2013foucault">(<a href="#ref-fontanagiusti2013foucault" role="doc-biblioref">Fontana-Giusti 2013</a>)</span>. Her book presents architecture as a material articulation of power that shapes not only the use of space but also the conduct of its users. Drawing on themes like the panopticon, spatial ordering, and institutional architecture, she shows that design decisions are deeply political acts—structuring bodies, behaviors, and subjectivities within normative spatial logics. <span class="citation" data-cites="sanli2024ideological">Şanlı and Selçuk (<a href="#ref-sanli2024ideological" role="doc-biblioref">2024</a>)</span> applies Foucault’s framework of governmentality to comparative urban analysis in Berlin and Ankara. They trace how state ideologies are manifested in urban morphology—from monumental public architecture to zoning laws and symbolic design. Using Lefebvre’s and Dovey’s interpretations alongside Foucault, they reveal that cities do not merely reflect but actively constitute political ideologies, embedding historical narratives and power shifts into their spatial fabric.</p>
</section>
</section>
<section id="methodology" class="level1">
<h1>Methodology</h1>
<div class="columns">
<div class="column">
<p>This study applies a spatially explicit methodology to evaluate the urban capabilities of Hamburg, integrating multi-source data and geospatial processing in R. The objective is to quantify and visualize urban attractivity and accessibility using reproducible and interpretable spatial techniques.</p>
<p>The analysis begins by defining the area of interest around central Hamburg. This area is projected into the UTM Zone 32N coordinate reference system to ensure spatial measurements in meters. A hexagonal grid with cells of approximately 1,000 square meters is constructed, enabling consistent spatial aggregation across the city. This grid acts as the analytical backbone for the attractivity index and ensures comparability across all subsequent metrics.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>aoi_bbox <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">xmin =</span> <span class="fl">9.626770</span>, <span class="at">ymin =</span> <span class="fl">53.383328</span>, <span class="at">xmax =</span> <span class="fl">10.351868</span>, <span class="at">ymax =</span> <span class="fl">53.748711</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>aoi <span class="ot">&lt;-</span> <span class="fu">st_as_sfc</span>(<span class="fu">st_bbox</span>(aoi_bbox), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>aoi_proj <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(aoi, <span class="dv">32632</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>hex_grid <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(aoi_proj, <span class="at">cellsize =</span> <span class="dv">1000</span>, <span class="at">square =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>hex_sf <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(<span class="at">geometry =</span> hex_grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<p>To populate each hexagon with relevant urban information, OpenStreetMap (OSM) is queried for a wide array of features. These include parks and green spaces, bars, restaurants, leisure infrastructure, subway and bus stations, and the Hamburg Hauptbahnhof. The proximity to these features and their densities within each hexagon form the foundational variables for assessing attractivity. Spatial joins and distance calculations are performed using the <code>sf</code>, <code>osmdata</code>, and <code>dplyr</code> packages in R.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(osmdata)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>osm_query <span class="ot">&lt;-</span> <span class="fu">opq</span>(<span class="at">bbox =</span> aoi_bbox) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_osm_feature</span>(<span class="at">key =</span> <span class="st">"amenity"</span>, <span class="at">value =</span> <span class="fu">c</span>(<span class="st">"bar"</span>, <span class="st">"restaurant"</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>bars_restaurants <span class="ot">&lt;-</span> osm_query <span class="sc">%&gt;%</span> <span class="fu">osmdata_sf</span>()</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>bars_sf <span class="ot">&lt;-</span> bars_restaurants<span class="sc">$</span>osm_points <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="dv">32632</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The attractivity index is then calculated for each hexagon by normalizing all relevant features using min-max scaling. For distance metrics, values are inverted so that proximity contributes positively to the index. Each component is assigned a weight, and the weighted components are aggregated to yield a final attractivity score between 0 and 1. These weights are customizable and documented transparently in the code, enabling alternative index constructions based on different policy priorities.</p>
</div>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>normalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (x <span class="sc">-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> (<span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>hex_sf<span class="sc">$</span>bar_score <span class="ot">&lt;-</span> <span class="fu">normalize</span>(hex_sf<span class="sc">$</span>bar_count)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>hex_sf<span class="sc">$</span>park_score <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">normalize</span>(hex_sf<span class="sc">$</span>dist_park_m)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>hex_sf<span class="sc">$</span>attractivity_index <span class="ot">&lt;-</span> <span class="fl">0.15</span> <span class="sc">*</span> hex_sf<span class="sc">$</span>bar_score <span class="sc">+</span> <span class="fl">0.15</span> <span class="sc">*</span> hex_sf<span class="sc">$</span>park_score <span class="sc">+</span> ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In parallel, public transport accessibility is analyzed using General Transit Feed Specification (GTFS) data provided by Hamburg’s transit authority (HVV). This data is parsed to extract all stops and their departure frequencies during peak morning hours (7:00–9:00). Stops with at least six departures per hour are classified as high-frequency. Buffers of 400 meters are generated around these stops to create service areas that represent convenient walking access to frequent transit.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytransit)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>gtfs <span class="ot">&lt;-</span> <span class="fu">read_gtfs</span>(<span class="st">"Data/hvv_gtfs.zip"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>stop_freq <span class="ot">&lt;-</span> <span class="fu">get_stop_frequency</span>(gtfs, <span class="at">start_time =</span> <span class="st">"07:00:00"</span>, <span class="at">end_time =</span> <span class="st">"09:00:00"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>high_freq_stops <span class="ot">&lt;-</span> stop_freq <span class="sc">%&gt;%</span> <span class="fu">filter</span>(departures_per_hr <span class="sc">&gt;=</span> <span class="dv">6</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>service_area <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(high_freq_stops_sf, <span class="at">dist =</span> <span class="dv">400</span>) <span class="sc">%&gt;%</span> <span class="fu">st_union</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>District-level spatial joins are used to assess how much of each administrative district falls within this well-serviced buffer. Metrics such as the total covered area, average frequency, and percentage coverage are calculated and used to evaluate equity in transit provision across Hamburg. The integration of these GTFS-based accessibility zones with attractivity scoring provides a dual-layered understanding of urban opportunity.</p>
<p>Additionally, walking isochrones are calculated from key transit hubs such as Hamburg Hauptbahnhof and Jungfernstieg. These isochrones define the area reachable by foot in 5, 10, and 15 minutes, based on average pedestrian speeds. By analyzing the average and maximum distances achieved within each time interval, the study gains insights into the spatial structure of walkability around key nodes.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>walking_speeds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>) <span class="co"># in minutes</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>iso_distances <span class="ot">&lt;-</span> walking_speeds <span class="sc">*</span> <span class="fl">1.2</span> <span class="sc">*</span> <span class="dv">60</span> <span class="co"># approx. meters/minute</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>isochrones <span class="ot">&lt;-</span> <span class="fu">lapply</span>(iso_distances, <span class="cf">function</span>(dist) <span class="fu">st_buffer</span>(hub_point_proj, dist))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The outputs of these analyses are visualized using interactive <code>leaflet</code> maps. These include a choropleth map of the attractivity index, district coverage maps of public transport access, and overlay maps combining walkability and transit buffers. Each map is enriched with popups and legends that explain the underlying data and methods.</p>
<p>In summary, this methodology blends land-use, pedestrian accessibility, and transit performance into a unified spatial framework. Through its combination of hexagonal grid analytics, isochrone modeling, and GTFS-based service profiling, it provides a multi-dimensional view of how Hamburg performs in terms of urban form and access. The approach is designed to be flexible, extensible, and directly informative for planners, policymakers, and engaged residents alike.</p>
<p><img src="https://cdn.pixabay.com/photo/2023/11/04/07/26/house-8364394_1280.jpg" class="img-fluid"></p>
</section>
<section id="analysis" class="level1">
<h1>Analysis</h1>
<iframe id="inlineFrameExample" title="Inline Frame Example" width="1200" height="1000" align="center" src="Widgets/info-card-hh.html">
</iframe>

<p>This section presents the analytical outcomes of the Hamburg urban capabilities assessment, based on spatial data, hexagonal attractivity indexing, and GTFS-derived public transit accessibility. The goal is to interpret the significance of the summarized metrics and evaluate how various urban components interact spatially across the city.</p>
<section id="urban-attractivity-patterns-across-hamburg" class="level2">
<h2 class="anchored" data-anchor-id="urban-attractivity-patterns-across-hamburg">Urban Attractivity Patterns Across Hamburg</h2>
<div class="columns">
<div class="column">
<p>Using a consistent spatial framework consisting of 1,312 hexagonal grid cells, we quantified and visualized the relative attractivity of urban space in Hamburg. Each hexagon was scored based on a composite index that factored in proximity to parks and the main train station, as well as densities of restaurants, bars, leisure sites, bus stops, and subway stations. The data used for these inputs were retrieved from OpenStreetMap and processed into spatial features.</p>
</div><div class="column">
<p>The results highlight that central boroughs such as Hamburg-Mitte, Altona, and Eimsbüttel contain clusters of hexagons with the highest attractivity scores. These areas benefit from short walking distances to green spaces and transport hubs, along with a high concentration of social and leisure infrastructure. The attractivity index ranged approximately between 0 and 1, with upper-quartile cells often achieving values above 0.75, particularly around central transport nodes and waterfront neighborhoods.</p>
</div>
</div>
<iframe id="inlineFrameExample" title="Inline Frame Example" width="1200" height="1000" src="Widgets/viz_map_index.html">
</iframe>
<p>A choropleth map depicting attractivity index scores across the hex grid enables a straightforward interpretation of these spatial dynamics. Additional plots, such as a histogram showing the distribution of scores and a tabular summary of the top 10 hexagons by index value, can help identify priority locations for urban investment or conservation.</p>
<iframe id="inlineFrameExample" title="Inline Frame Example" width="900" height="1300" align="center" src="Widgets/info-card-hex.html">
</iframe>

</section>
<section id="public-transit-accessibility-and-spatial-coverage" class="level2">
<h2 class="anchored" data-anchor-id="public-transit-accessibility-and-spatial-coverage">Public Transit Accessibility and Spatial Coverage</h2>
<p>The GTFS analysis focused on service frequency between 07:00 and 09:00, representing peak commuting hours. A threshold of six departures per hour was used to classify stops as high-frequency. The dataset included 7,122 stops operating within the defined BBOX, out of which 1,798 met the high-frequency criterion.</p>
<iframe id="inlineFrameExample" title="Inline Frame Example" width="1000" height="700" src="Widgets/pt_map_filtered_clipped_straightforward.html">
</iframe>
<p>To assess spatial accessibility, 400-meter buffers were generated around each high-frequency stop. These buffers were merged and clipped to the analysis boundary. The result was a contiguous area of approximately 146 km², which reflects well-serviced zones with convenient access to public transport during peak hours.</p>
<p>An analysis of district-level coverage indicated that inner-city areas, including Hamburg-Mitte and Eimsbüttel, had greater than 80% coverage within the clipped buffer area. In contrast, outer districts such as Harburg and Bergedorf had significantly lower coverage, often falling below 50%. These disparities underscore a spatial mismatch between transit service levels and urban expansion, suggesting the need for targeted mobility improvements in peripheral neighborhoods.</p>
<iframe id="inlineFrameExample" title="Inline Frame Example" width="900" height="1300" align="center" src="Widgets/info-card-hvv.html">
</iframe>

</section>
<section id="walking-isochrone-accessibility-from-transit-hubs" class="level2">
<h2 class="anchored" data-anchor-id="walking-isochrone-accessibility-from-transit-hubs">Walking Isochrone Accessibility from Transit Hubs</h2>
<p>To evaluate last-mile accessibility and pedestrian reach, we computed walking isochrones from major transport hubs, including Hamburg Hauptbahnhof and Jungfernstieg. Isochrones were generated for 5-, 10-, and 15-minute intervals, using average pedestrian speed assumptions.</p>
<p>The analysis shows that in a 5-minute walk, individuals can access an average distance of approximately 185 meters. This increases to around 460 meters for 10 minutes and nearly 700 meters for 15 minutes. Maximum walking distances within these intervals reach up to 950 meters in favorable conditions. These values were consistent across hubs, indicating a generally compact and walkable core area in central Hamburg.</p>
<p>These results tie into the broader concept of <strong>walkability</strong>, which refers to how conducive an environment is to walking. Key elements include the presence and connectivity of sidewalks, pedestrian-friendly infrastructure, proximity to key services and amenities, and safety. In our case, walkability is measured both by the spatial distribution of amenities within close walking distances and the temporal reach from transport nodes. The isochrone maps demonstrate how far an average pedestrian can move within a given time frame, while the attractivity index integrates this with destination density.</p>
<p>Thus, the combination of hexagon-level amenity scoring and radial isochrones enables us to understand walkability both from a network accessibility and land-use intensity perspective. The areas with high overlap between high attractivity and broad walkable reach from major hubs reflect superior pedestrian-oriented planning. In contrast, hexagons with fewer reachable destinations or isolated amenities highlight potential urban gaps.</p>
<p>Importantly, walkability does not exist in isolation but is deeply augmented by access to high-frequency public transport. When pedestrians are within short walking distance of transit nodes offering regular service, the effective reach of their movement across the city multiplies. This co-location of high attractivity and transit access enables a synergistic model of mobility—walkable streets feed into an efficient transit network, allowing individuals to easily transition from short walks to rapid travel over longer distances.</p>
<iframe id="inlineFrameExample" title="Inline Frame Example" width="1000" height="700" src="Widgets/info-card-walk.html">
</iframe>
<p>This integration creates a layered mobility environment, often referred to as the “walk-and-ride” dynamic, in which urban areas combine the advantages of compact pedestrian districts with the time-efficiency of public transport. In the case of Hamburg, zones such as Hauptbahnhof and Jungfernstieg illustrate this concept well. These hubs not only provide the geographic core of the network but also maximize access to a diversity of amenities within both walking and transit-enabled isochrones. The outcome is a kind of urban permeability that enhances both equity and sustainability.</p>
<iframe id="inlineFrameExample" title="Inline Frame Example" width="1000" height="700" src="Widgets/Walkability.html">
</iframe>
<p>Expanding this model beyond the city center—by improving service frequency in underserved neighborhoods or introducing complementary pedestrian infrastructure—can elevate walkability standards citywide. This also helps reduce dependency on cars, supports active travel, and makes the urban environment more inclusive, particularly for those without access to private vehicles.</p>
</section>
<section id="integrated-analysis-of-urban-quality-and-mobility" class="level2">
<h2 class="anchored" data-anchor-id="integrated-analysis-of-urban-quality-and-mobility">Integrated Analysis of Urban Quality and Mobility</h2>
<p>By combining attractivity scores with transit accessibility, a more nuanced view of Hamburg’s urban fabric emerges. Areas that score highly on both dimensions—such as the city center and parts of Altona—represent well-functioning, accessible, and vibrant urban spaces. These zones can serve as exemplars for integrated urban design and policy.</p>
<p>However, some areas with mid-to-high attractivity scores are underserved by frequent transit. These may be undergoing recent development or may suffer from historical underinvestment. Identifying and prioritizing these spatial gaps is crucial for equitable city planning.</p>
<p>Cross-referencing hexagon scores and buffer zones in a spatial overlay or categorical heatmap can visually highlight these disparities. Additionally, plotting index distributions inside versus outside the serviced buffer area can quantify how transport infrastructure influences overall urban quality.</p>
<p>The findings of this analysis point to several key areas for action. Firstly, high-attractivity zones should be preserved and enhanced through planning measures that limit overdevelopment while supporting quality of life. Secondly, transit service upgrades should focus on districts with relatively poor buffer coverage and rising land-use intensity. Thirdly, integrating walkability assessments with transport access can help optimize the placement of new services and ensure equitable access.</p>
<p>Ultimately, the hex-based spatial approach presented here offers a flexible and data-rich foundation for urban diagnostics, investment prioritization, and long-term monitoring of city performance.</p>
<p><img src="https://cdn.pixabay.com/photo/2018/07/06/22/56/skyscraper-3521328_1280.jpg" class="img-fluid"></p>

</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-alexander1977" class="csl-entry" role="listitem">
Alexander, Christopher, Sara Ishikawa, and Murray Silverstein. 1977. <em>A Pattern Language: Towns, Buildings, Construction</em>. Oxford University Press.
</div>
<div id="ref-barnett2006" class="csl-entry" role="listitem">
Barnett, Jonathan. 2006. <span>“The Way We Were, the Way We Are: The Theory and Practice of Designing Cities Since 1956.”</span> <em>Harvard Design Magazine</em>.
</div>
<div id="ref-barros2023urbano" class="csl-entry" role="listitem">
Barros, João Roberto. 2023. <span>“Espaço Urbano e Relações de Poder a Partir de Michel Foucault.”</span> <em>Revista de Ciências Do Estado</em>. <a href="https://doi.org/10.35699/2525-8036.2023.42142">https://doi.org/10.35699/2525-8036.2023.42142</a>.
</div>
<div id="ref-fontanagiusti2013foucault" class="csl-entry" role="listitem">
Fontana-Giusti, Gordana. 2013. <em>Foucault for Architects</em>.
</div>
<div id="ref-harfield2010social" class="csl-entry" role="listitem">
Harfield, S. 2010. <span>“Urban Design as Social Benefit: Thinking Beyond Formality and Physicality.”</span>
</div>
<div id="ref-hebbert2017historical" class="csl-entry" role="listitem">
Hebbert, Michael. 2017. <span>“Historical Exploration/Explanation in Urban Design.”</span> <a href="https://doi.org/10.4324/9781315581606-37">https://doi.org/10.4324/9781315581606-37</a>.
</div>
<div id="ref-hoffmann2001perspective" class="csl-entry" role="listitem">
Hoffmann, Oliver, Markus Stumptner, and Talik Chalabi. 2001. <span>“A Perspective Based Approach to Design.”</span>
</div>
<div id="ref-kirsanova2024space" class="csl-entry" role="listitem">
Kirsanova, Yuliya A. 2024. <span>“The Concept of Space in the Philosophy of m. Foucault: The Territorial Nature of Power.”</span> <em>Общество: Философия, История, Культура</em>. <a href="https://doi.org/10.24158/fik.2024.12.25">https://doi.org/10.24158/fik.2024.12.25</a>.
</div>
<div id="ref-laurence2006jacobs" class="csl-entry" role="listitem">
Laurence, Peter L. 2006. <span>“The Death and Life of Urban Design: Jane Jacobs, the Rockefeller Foundation and the New Research in Urbanism, 1955–1965.”</span> <em>Journal of Urban Design</em> 11 (2): 145–72. <a href="https://doi.org/10.1080/13574800600644001">https://doi.org/10.1080/13574800600644001</a>.
</div>
<div id="ref-lima2015digital" class="csl-entry" role="listitem">
Lima, Isabel Cristina, Fernando Toledo Lima, and Maria Carolina Mazivieiro. 2015. <span>“Urbanismo Na Era Digital: Desenho Urbano e Processos Digitais.”</span> In <em>Proceedings of SIGraDi</em>. <a href="https://doi.org/10.5151/DESPRO-SIGRADI2015-SP120303">https://doi.org/10.5151/DESPRO-SIGRADI2015-SP120303</a>.
</div>
<div id="ref-madanipour2007reason" class="csl-entry" role="listitem">
Madanipour, Ali. 2007. <em>Designing the City of Reason: Foundations and Frameworks</em>. Routledge.
</div>
<div id="ref-maghraoui2017mobility" class="csl-entry" role="listitem">
Maghraoui, Ouail Al, Flore Vallet, Jakob Puchinger, and Bernard Yannou. 2017. <span>“Framing Key Concepts to Design a Human Centered Urban Mobility System.”</span>
</div>
<div id="ref-oktay2016critical" class="csl-entry" role="listitem">
Oktay, Derya. 2016. <span>“A Critical Review on the Current Thought and Practice of Urban Design: New Roles in the Future.”</span>
</div>
<div id="ref-plowright2022humans" class="csl-entry" role="listitem">
Plowright, Philip D., and Anirban Adhya. 2022. <em>Urban Design Made by Humans</em>. <a href="https://doi.org/10.4324/9781003254935">https://doi.org/10.4324/9781003254935</a>.
</div>
<div id="ref-raposo2006diseno" class="csl-entry" role="listitem">
Raposo, Alfonso. 2006. <span>“DISEÑO URBANO. Indagaciones Genealógicas y Perfiles Institucionales.”</span>
</div>
<div id="ref-sanli2024ideological" class="csl-entry" role="listitem">
Şanlı, Tuğçe, and Yasemin Selçuk. 2024. <span>“Reading Ideological Power Representations Through Space: The Tale of Two Cities Berlin and Ankara.”</span> <em>Kent Akademisi</em>. <a href="https://doi.org/10.35674/kent.1477332">https://doi.org/10.35674/kent.1477332</a>.
</div>
<div id="ref-sepe2014place" class="csl-entry" role="listitem">
Sepe, Marichela, and Michael Pitt. 2014. <span>“The Characters of Place in Urban Design.”</span> <em>Urban Design International</em> 19: 43–56. <a href="https://doi.org/10.1057/UDI.2013.32">https://doi.org/10.1057/UDI.2013.32</a>.
</div>
<div id="ref-shahreen2012sustainability" class="csl-entry" role="listitem">
Shahreen, Fareea. 2012. <span>“Urban Design Theory and Practice Aimed at Sustainability. The Liverpool Study Cases in the United Kingdom Planning System.”</span> PhD thesis, Politecnico di Torino. <a href="https://doi.org/10.6092/POLITO/PORTO/2497518">https://doi.org/10.6092/POLITO/PORTO/2497518</a>.
</div>
<div id="ref-sonne2005birth" class="csl-entry" role="listitem">
Sonne, Wolfgang. 2005. <span>“The Birth of Urban Design History Out of the Spirit of Multidisciplinarity.”</span> <a href="https://doi.org/10.4000/BOOKS.INHA.1624">https://doi.org/10.4000/BOOKS.INHA.1624</a>.
</div>
<div id="ref-harvard2006" class="csl-entry" role="listitem">
<span>“The Origins and Evolution of "Urban Design," 1956–2006.”</span> 2006. <em>Harvard Design Magazine</em>.
</div>
<div id="ref-urban2023cities" class="csl-entry" role="listitem">
<em>Urban Design: Cities in Past, Present and Future</em>. 2023. SciSpace.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>